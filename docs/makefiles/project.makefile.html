<p>-e </p>
<h1 id="project-makefile-md">project.makefile.md</h1>
<p><code>project.makefile</code> </p>
<h3 id="project-management-makefile">Project Management makefile</h3>
<p>Install directory skeleton and project configs.<br>Installs npm packages for compiling.<br>Handles peer version control of local makefiles and configs. </p>
<p><code>common.makefile</code> </p>
<h3 id="common-makefile-library">Common Makefile Library</h3>
<p>Base makefile library<br>This is included from a top level makefile.<br>-e </p>
<h1 id="targets">TARGETS</h1>
<p>.DEFAULT_GOAL = all </p>
<p><code>common.makefile</code> </p>
<p><strong>help</strong>: print this message </p>
<p><strong>printall</strong>: print all public type variables (no underscore; defined in file or command line or environment override) </p>
<p><strong>printall-raw</strong>: print all variables and values known to make </p>
<p><strong>print-%</strong>: print-varname - prints the value of varname </p>
<p><strong>help-use</strong>: print USE_VARNAME type help </p>
<p><strong>help-file</strong>: print help for makefile </p>
<p><strong>help-extra</strong>: print extra help </p>
<p><code>project.makefile</code> </p>
<p><strong>all</strong>: runs files and npm-install rules </p>
<p><strong>files</strong>: install new files from <code>DIR_PRJ_ROOT</code> </p>
<p><strong>clean</strong>: removes files that were added by all rule using the manifset file in <code>DIR_CACHE</code> </p>
<p><strong>npm-install</strong>: install compile plugins locally </p>
<p><strong>npm-install-global</strong>: installs compile tools globaly for command line usage </p>
<p><strong>diffs</strong>: make diff files if needed from MANIFEST files<br>    Uses <code>git merge-file &lt;current-file&gt; &lt;base-file&gt; &lt;other-file&gt;</code> where<br>    where current is your local file; base-file is the original repo file from <code>make install</code>;<br>    and other-file is the new repo file. If there is difference will create a file named<br>    your-file.diff. It is up to the caller to merge the difference by hand. After<br>    edits are finished and integerated into your source (FIXME see FILE_COMMIT)\ reinstall files to get a new commit hash. </p>
<p><strong>.makefilejs/COMMIT</strong>: copys skeleton directory and git commit hash from <code>DIR_PRJ_ROOT</code> </p>
<p><strong>.makefilejs/MANIFEST</strong>: record of files from skeleton directory in <code>DIR_PRJ_ROOT</code><br>-e </p>
<h1 id="use-variables">USE VARIABLES</h1>
<p><code>common.makefile</code> </p>
<p><em>Because of technically difficulity in mdless: USE MDLESS should be USE_MDLESS and so on.</em><br><strong>USE MDLESS</strong>: use <a href="https://github.com/ttscoff/mdless">mdless</a> command to form command line markdown output<br><strong>USE COLOR</strong>: colorize output<br>-e </p>
<h1 id="extra-help">EXTRA HELP</h1>
<p><code>common.makefile</code> </p>
<p>run <code>make help</code> see top level non-pattern rules<br>run <code>make help-file</code> help for each included file<br>run <code>make help-use</code> help for USE_\% type variables<br>run <code>make -j 8</code> to run with 8 threads in paralell (set the number to number of cores)!<br>run <code>make -n</code> for a dry run that will print out the actually commands it would have used<br>run <code>make --trace</code> to see all recipe shell commands<br>run <code>make --debug=b</code> basic debug dependency chain </p>
<h4 id="dont-set-bool-type-variables-to-zero-">Dont set bool type variables to zero.</h4>
<p>BAD: <code>USE_THINGY :=0</code><br>GOOD: <code>USE_THINGY :=</code><br>This is because make usually checks for existance of variable being set. </p>
<h4 id="watch-out-with-spaces-when-setting-variables-">Watch out with spaces when setting variables.</h4>
<p>Make is very literal in setting things.<br>BAD: <code>DIR_BASE := .. \\n</code># will evaluate to ..<br>GOOD: <code>DIR_BASE := ..\\n</code># will evaluate to ..<br>So the value starts right after assingment symbol and ends at newline or comment hash. </p>
<h4 id="dont-set-variables-with-the-environment">Dont set variables with the environment</h4>
<p>The -e switch will push the whole environment in and who knows whats in there.<br>Setting variables after the the make command will isolate and document what you are trying to do.<br>BAD: <code>USE_THINGY=1 make -e</code># set through environment<br>GOOD: <code>make USE_THINGY=1</code># set by make<br>Unsetting variables on the command line<br>GOOD: <code>make USE_THINGY=</code></p>
